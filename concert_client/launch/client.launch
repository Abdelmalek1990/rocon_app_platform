<launch>
  <arg name="concert_name" default="concert"/>
  <arg name="robot_name" default="concert_client"/>
  <arg name="robot_type" default="turtlebot"/>
  
  <node ns="zeroconf" pkg="zeroconf_avahi" type="zeroconf" name="zeroconf"/>
  
  <node pkg="rocon_gateway" type="gateway.py" name="gateway" output="screen">
    <rosparam command="load" file="$(find rocon_gateway)/param/default.yaml"/>
    <rosparam command="load" file="$(find rocon_gateway)/param/default_blacklist.yaml"/>
    <param name="name" value="$(arg robot_name)"/>
    <param name="hub_whitelist" value="[$(arg concert_name)]"/>
  </node>
  
  <node pkg="concert_client" type="concert_client.py" name="concert_client" output="screen">
    <remap from="concert_client/gateway_info" to="gateway/gateway_info"/>
    <remap from="concert_client/flip" to="gateway/flip"/>
    <remap from="concert_client/init" to="appmanager/init"/>
    <remap from="concert_client/relay_invitation" to="appmanager/invitation"/>
    <remap from="concert_client/apiflip_request" to="appmanager/apiflip_request"/>
  </node>

  <node pkg="rocon_appmanager" type="app_manager.py" name="appmanager" output="screen">
    <rosparam command="load" file="$(find rocon_appmanager)/param/default.yaml" />
    <param name="app_from_source_directory" value="$(find rocon_apps)"/>
    <param name="robot_name" value="$(arg robot_name)"/>
    <param name="robot_type" value="$(arg robot_type)"/>
    <remap from="appmanager/flip" to="gateway/flip"/>
    <remap from="appmanager/advertise" to="gateway/advertise"/>
    <remap from="appmanager/pull" to="gateway/pull"/>
  </node>

</launch>
